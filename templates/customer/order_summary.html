{% extends 'base.html' %}
{% block title %}ออเดอร์ #{{ order.id }} - {{ table.name }}{% endblock %}
{% block content %}
<div class="toolbar">
    <h2>ออเดอร์ #{{ order.id }}</h2>
    <a class="btn" href="{{ url_for('table_view', code=table.code) }}">ย้อนกลับไปเลือกเมนู</a>
</div>

<section class="card">
    <h3>สถานะออเดอร์: {{ order.status }}</h3>
    <table class="data-table">
        <thead>
            <tr>
                <th>เมนู</th>
                <th>จำนวน</th>
                <th>ราคา/หน่วย</th>
                <th>รวม</th>
            </tr>
        </thead>
        <tbody>
            {% for item in order.items %}
            <tr>
                <td>{{ item.menu_item.name }}</td>
                <td>{{ item.quantity }}</td>
                <td>{{ '%.2f'|format(item.price) }}</td>
                <td>{{ '%.2f'|format(item.subtotal) }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <p class="total">ยอดรวมทั้งหมด: <strong>{{ '%.2f'|format(order.total_amount) }} บาท</strong></p>
    {% if order.status == 'paid' %}
    <p class="success">ออเดอร์นี้ชำระเงินเรียบร้อยแล้ว ขอบคุณที่ใช้บริการ</p>
    {% endif %}
</section>

<section class="card">
    <h3>ต้องการพนักงานช่วยเหลือ?</h3>
    {% if order.requested_assistance %}
        <p>พนักงานได้รับแจ้งเรียบร้อย โปรดรอสักครู่</p>
    {% else %}
        <form method="post" action="{{ url_for('customer_call_staff', code=table.code, order_id=order.id) }}">
            <button type="submit" class="btn primary">กดเรียกพนักงาน</button>
        </form>
    {% endif %}
</section>
{% endblock %}
