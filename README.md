# ระบบสั่งอาหารผ่าน QR Code

โปรเจกต์ตัวอย่างสำหรับระบบสั่งอาหารภายในร้านอาหารที่รองรับการสแกน QR Code แยกตามโต๊ะ ลูกค้า พนักงาน และผู้ดูแลระบบสามารถใช้งานผ่านหน้าเว็บได้

## คุณสมบัติหลัก

- **ลูกค้า**
  - สแกน QR Code ตามโต๊ะเพื่อเปิดหน้าเมนู
  - เลือกจำนวนอาหารและส่งออเดอร์ผ่านมือถือ
  - ตรวจสอบบิลล่าสุดและกดเรียกพนักงานได้
- **พนักงาน**
  - สร้างออเดอร์ให้ลูกค้าได้จากหลังบ้าน
  - ดูรายการออเดอร์ทั้งหมด เปลี่ยนสถานะ และออกบิลเมื่อชำระเงิน
  - ตรวจสอบการเรียกพนักงานจากลูกค้า
- **ผู้ดูแลระบบ (Admin)**
  - จัดการเมนูอาหาร เพิ่ม/แก้ไข/ลบรายการได้
  - จัดการโต๊ะและดาวน์โหลด QR Code สำหรับแต่ละโต๊ะ
  - ดูภาพรวมยอดขายรวมและยอดขายประจำวัน

## โครงสร้างเทคโนโลยี

- [Flask](https://flask.palletsprojects.com/) + [Flask-SQLAlchemy](https://flask-sqlalchemy.palletsprojects.com/) สำหรับเว็บเซิร์ฟเวอร์และ ORM
- ฐานข้อมูล SQLite (ไฟล์ `restaurant.db` จะถูกสร้างอัตโนมัติเมื่อรันแอป)
- ไลบรารี [qrcode](https://pypi.org/project/qrcode/) สำหรับสร้าง QR Code ของโต๊ะ

## การเริ่มต้นใช้งาน

1. สร้าง virtual environment และติดตั้ง dependencies

   ```bash
   python -m venv .venv
   source .venv/bin/activate  # หรือบน Windows ใช้ .venv\Scripts\activate
   pip install -r requirements.txt
   ```

2. รันแอปพลิเคชัน

   ```bash
   flask --app app run
   ```

   หรือใช้ `python app.py` เพื่อรันในโหมดพัฒนา (debug)

3. เปิดเบราว์เซอร์ไปที่ `http://localhost:5000`

   - บัญชีตัวอย่างสำหรับทดสอบ
     - ผู้ดูแลระบบ: `admin / admin123`
     - พนักงาน: `staff / staff123`

4. สำหรับลูกค้าให้เปิดลิงก์ `http://localhost:5000/table/T1` (หรือรหัสโต๊ะอื่น ๆ) หรือดาวน์โหลด QR Code จากเมนูผู้ดูแลระบบ

## การใช้งานผ่าน Docker

สำหรับการใช้งานที่สะดวกต่อการ deploy สามารถรันระบบผ่าน Docker ได้ดังนี้

1. สร้าง image

   ```bash
   docker build -t qr-ordering .
   ```

2. รันคอนเทนเนอร์ (เปิดพอร์ต 5000 และกำหนดค่า Secret Key)

   ```bash
   docker run --rm -p 5000:5000 \
     -e SECRET_KEY="your-production-secret" \
     --name qr-ordering qr-ordering
   ```

   จากนั้นเปิดเว็บที่ `http://localhost:5000`

3. (ทางเลือก) หากต้องการเก็บฐานข้อมูลไว้ภายนอกคอนเทนเนอร์ ให้สร้างโฟลเดอร์ `data` แล้วสั่งรันดังนี้

   ```bash
   mkdir -p data
   docker run --rm -p 5000:5000 \
     -e SECRET_KEY="your-production-secret" \
     -e DATABASE_URL="sqlite:////app/data/restaurant.db" \
     -v $(pwd)/data:/app/data \
     --name qr-ordering qr-ordering
   ```

   ค่าการเชื่อมต่อฐานข้อมูล (`DATABASE_URL`) สามารถเปลี่ยนเป็นระบบอื่นได้ตามต้องการ เช่น PostgreSQL หรือ MySQL

## โครงสร้างฐานข้อมูลเริ่มต้น

เมื่อรันแอปครั้งแรก ระบบจะสร้างข้อมูลตัวอย่างให้อัตโนมัติ ได้แก่

- ผู้ใช้ `admin` (role `admin`) และ `staff` (role `staff`)
- โต๊ะตัวอย่าง 3 โต๊ะ (`T1`, `T2`, `VIP`)
- เมนูอาหารพื้นฐาน 4 รายการ

## หมายเหตุการพัฒนา

- ระบบใช้ session ของ Flask ในการจัดการการเข้าสู่ระบบ (ไม่มีการเข้ารหัส JWT หรือ OAuth)
- หากต้องการเริ่มข้อมูลใหม่ให้ลบไฟล์ `restaurant.db` แล้วรันโปรแกรมอีกครั้ง ระบบจะสร้างข้อมูลตั้งต้นให้ใหม่
- รหัสผ่านถูกเก็บในรูปแบบ Hash ด้วย Werkzeug security

## ใบอนุญาต

โค้ดนี้เผยแพร่ภายใต้ MIT License คุณสามารถนำไปปรับใช้หรือแก้ไขได้ตามความเหมาะสม
